{{- /*
###
# .zshrc - Run on interactive Zsh session.
###
*/ -}}

# Enable Powerlevel10k instant prompt.
{{- /* Should stay close to the top of ~/.zshrc. */}}
{{- /* Initialization code that may require console input (password prompts, [y/n] */}}
{{- /* confirmations, etc.) must go above this block, everything else may go below. */}}
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

###
# Init Zim
###

# Module configs
zstyle ':zim:zmodule' use 'degit'
zstyle ':zim:input' double-dot-expand yes
zstyle ':zim:git' aliases-prefix 'g'

# Initialize modules.
source ${ZIM_HOME}/init.zsh

###
# Shell configs
###

source ~/.config/sh/aliases

# Completion
setopt complete_in_word        {{- /* Complete from both ends of a word. */}}
setopt always_to_end           {{- /* Move cursor to the end of a completed word. */}}
setopt auto_menu               {{- /* Show completion menu on a successive tab press. */}}
setopt auto_list               {{- /* Automatically list choices on ambiguous completion. */}}
setopt auto_param_slash        {{- /* If completed parameter is a directory, add a trailing slash. */}}
setopt extended_glob           {{- /* Needed for file modification glob modifiers with compinit. */}}
setopt NO_menu_complete        {{- /* Do not autoselect the first completion entry. */}}
setopt NO_flow_control         {{- /* Disable start/stop characters in shell editor. */}}

# History
setopt bang_hist               {{- /* Treat the '!' character specially during expansion. */}}
setopt extended_history        {{- /* Write the history file in the ':start:elapsed;command' format. */}}
setopt hist_expire_dups_first  {{- /* Expire a duplicate event first when trimming history. */}}
setopt hist_find_no_dups       {{- /* Do not display a previously found event. */}}
setopt hist_ignore_all_dups    {{- /* Delete an old recorded event if a new event is a duplicate. */}}
setopt hist_ignore_dups        {{- /* Do not record an event that was just recorded again. */}}
setopt hist_ignore_space       {{- /* Do not record an event starting with a space. */}}
setopt hist_reduce_blanks      {{- /* Remove extra blanks from commands added to the history list. */}}
setopt hist_save_no_dups       {{- /* Do not write a duplicate event to the history file. */}}
setopt hist_verify             {{- /* Do not execute immediately upon history expansion. */}}
setopt inc_append_history      {{- /* Write to the history file immediately, not when the shell exits. */}}
setopt NO_hist_beep            {{- /* Don't beep when accessing non-existent history. */}}
setopt NO_share_history        {{- /* Don't share history between all sessions. */}}
{{ if (eq .chezmoi.os "darwin") -}}
export HISTFILE="${XDG_CACHE_HOME:-$HOME/.cache}/zsh/zsh_history"
export SAVEHIST=10000          {{- /* Save more history items into the file (default 2000) */}}
export HISTSIZE=10000          {{- /* Show more history items when read from the file (default 2000) */}}
{{ end -}}

{{/*
# Init Powerlevel10k prompt
# To customize prompt, run `p10k configure` or edit $ZDOTDIR/p10k.zsh.
*/ -}}
[[ ! -f {{ .chezmoi.homeDir }}/.config/zsh/p10k.zsh ]] || source {{ .chezmoi.homeDir }}/.config/zsh/p10k.zsh
